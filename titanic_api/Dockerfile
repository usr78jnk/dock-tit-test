# С начала мы говорим докеру, что возьми за основу вот такой контейнер
# В нашем случае - это минимальная версия python:3.11-slim
FROM python:3.11-slim
# Тем свмым мы закачаем себе некую линукс машину, в которой уже установлен питон нужной нам версии

# Задаем рабочую директорию, ну что-то похожее есть у нас когда мы разрабатывали проект
WORKDIR	/app

#Up to date
#Далее нам нужно установить все необходимые программы, 
# Мы прописываем теже самые команды здесь, так как бы мы их делали в терминале
RUN apt-get update && apt-get install -y \
    build-essential \
    curl \
#    software-properties-common \
    && rm -rf /var/lib/apt/lists/*
# И заодно чистим логи, незачем нам они

# Затем со своего компа, со совей рабочей директории копируем файл с зависимостями
COPY ./titanic_api/requirements.txt /app

# Далее установка, тех самых завиисимостей, и знакомая нам команда RUN
RUN pip3 install -r requirements.txt

# не хорошо копировать все подряд, но есть решение, ао аналогии с GitHub - 
# создвть .dockerignore
COPY ./titanic_api /app

# Как оказалось, CMD - будет выполнятся при запуске контейнера
# в отличии от RUN - который работает при сборке контейнера
# Но как-бы не было абсурдно команда CMD запускается командой - docker run
CMD ["python3", "app_api.py"]



